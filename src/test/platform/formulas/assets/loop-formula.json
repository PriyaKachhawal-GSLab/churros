{
  "name": "loop-formula",
  "active": true,
  "configuration": [{
    "name": "sfdc.instance.id",
    "description": "The SFDC element instance that will trigger this formula.",
    "type": "elementInstance",
    "key": "sfdc.instance.id",
    "required": true
  }],
  "triggers": [{
    "type": "event",
    "properties": {
      "elementInstanceId": "${sfdc.instance.id}"
    },
    "onSuccess": [
      "create-list"
    ]
  }],
  "steps": [{
    "name": "create-list",
    "type": "script",
    "properties": {
      "scriptEngine": "v1",
      "mimeType": "application/javascript",
      "body": "\nvar list = [];\nfor (var i = 0; i < 50; i ++) {\n  list.push({\n    name: 'churros-name-' + i,\n    index: i\n  })\n}\n\nreturn {\n  list: list\n};"
    },
    "onSuccess": [
      "looper"
    ]
  }, {
    "name": "get-element-by-key",
    "type": "request",
    "properties": {
      "method": "GET",
      "api": "/elements/sfdc"
    },
    "onSuccess": [
      "looper"
    ]
  }, {
    "name": "looper",
    "type": "loop",
    "properties": {
      "list": "${steps.create-list.list}"
    },
    "onSuccess": [
      "get-element-by-key"
    ]
  }]
}
