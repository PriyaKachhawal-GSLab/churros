[{
  "name": "A-manual-formula",
  "configuration": [{
    "key": "crm.instance",
    "name": "crm.instance",
    "type": "elementInstance"
  }],
  "triggers": [{
    "type": "event",
    "onSuccess": ["A-build-args"],
    "properties": {
      "elementInstanceId": "${crm.instance}"
    }
  }],
  "steps": [{
    "name": "A-build-args",
    "type": "script",
    "onSuccess": ["A-sub-formula"],
    "properties": {
      "body": "done( { resource: 'accounts', payload:{ Name: 'churros-test-name' }});"
    }
  }, {
    "name": "A-sub-formula",
    "type": "formula",
    "onSuccess": ["A-end"],
    "properties": {
      "formulaId": "SUB_FORMULA_ID",
      "args": "${steps.A-build-args}"
    }
  }, {
    "name": "A-end",
    "type": "script",
    "properties": {
      "body": "done({createdId: steps['A-sub-formula'].id});"
    }
  }]
}, {
  "name": "B-manual-formula-create-resource",
  "configuration": [{
    "key": "crm.instance",
    "name": "crm.instance",
    "type": "elementInstance"
  }],
  "triggers": [{
    "type": "manual",
    "onSuccess": ["B-create-resource"]
  }],
  "steps": [{
    "name": "B-create-resource",
    "type": "elementRequest",
    "onSuccess": ["B-aggregate-fields"],
    "properties": {
      "elementInstanceId": "${crm.instance}",
      "api": "/hubs/crm/{resource}",
      "method": "POST",
      "path": "${trigger.args}",
      "body": "${trigger.args.payload}"
    }
  }, {
    "name": "B-aggregate-fields",
    "onSuccess": ["B-retrieve-resource"],
    "type": "script",
    "properties": {
      "body": "done({resource: trigger.args.resource, id: steps['B-create-resource'].response.body.Id});"
    }
  }, {
    "name": "B-retrieve-resource",
    "type": "elementRequest",
    "onSuccess": ["B-end"],
    "properties": {
      "elementInstanceId": "${crm.instance}",
      "api": "/hubs/crm/{resource}/{id}",
      "method": "GET",
      "path": "${steps.B-aggregate-fields}"
    }
  }, {
    "name": "B-end",
    "type": "script",
    "properties": {
      "body": "done({id: steps['B-aggregate-fields'].id});"
    }
  }]
}, {
  "name": "child-accepts-configs",
  "steps": [{
    "name": "childScript",
    "type": "script",
    "properties": {
      "body": "done({\n  child: config.child,\n  overRideConfig: config.over.ride.test,\n  parent: config.parent\n});"
    }
  }],
  "triggers": [{
    "onSuccess": [
      "childScript"
    ],
    "type": "manual",
    "async": true,
    "name": "trigger"
  }],
  "configuration": [{
      "key": "child",
      "name": "child",
      "type": "value",
      "required": true
    },
    {
      "key": "over.ride.test",
      "name": "over.ride.test",
      "type": "value",
      "required": true
    }
  ]
}, {
  "name": "parent-passes-conifigs",
  "steps": [{
      "name": "last",
      "type": "script",
      "properties": {
        "body": "done({\n  body: { parent: config.parent,\n  overRideConfig: config.over.ride.test\n}});"
      }
    },
    {
      "onSuccess": [
        "last"
      ],
      "name": "subformula",
      "type": "formula",
      "properties": {
        "subFormulaConfigs": "${steps.build.configs}",
        "formulaId": "SUB_FORMULA_ID"
      }
    },
    {
      "onSuccess": [
        "subformula"
      ],
      "name": "build",
      "type": "script",
      "properties": {
        "body": "done({\n  configs: {\n    child: 'child',\n    'over.ride.test' : 'child'\n  }\n})"
      }
    }
  ],
  "triggers": [{
    "onSuccess": [
      "build"
    ],
    "type": "event",
    "properties": {
      "elementInstanceId": "${crm.instance}"
    }
  }],
  "configuration": [{
      "key": "parent",
      "name": "parent",
      "type": "value"
    },
    {
      "key": "over.ride.test",
      "name": "over.ride.test",
      "type": "value"
    },
    {
      "key": "crm.instance",
      "name": "crm.instance",
      "type": "elementInstance"
    }
  ]
}]
